<!DOCTYPE html>
<html>
<head>
	<title>车辆路线 </title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	<script src="jquery-1.9.0.js"  type="text/javascript"></script>
	<script src="RMap5.js" type="text/javascript"></script>
	<style>
	html,body{
		width:100%;
		height:100%;
		margin:0;
		padding:0;
	}
	.locus_contain2{
		width: 100%;
		height: 100%;
	}

	#map{
		width: 100%;
		height: 100%;
		position: absolute;
	}
	.playSchedule{
		z-index: 99;
		position: absolute;
		bottom: 100px;
		left: 50px;
		width: 500px;
	}
	
	.locusmap-his-button {
		width: 100%;
		background: black;
		border: 0px;
		cursor: pointer;
		color: white;
		font-size: 15px;
		display: inline-block;
		position: relative;
		left: 5px;
		height: 100%;
		width: 90px;
		line-height: 30px;
		text-align: center;
		border-radius: 5px;
		margin-right: 10px;
	}
	</style>
</head>

<body>


<div id="locus_contain2">
	<div id='map'></div>
</div>



</body>

<script type="text/javascript">
	var Map;
    var numMapLat = 28.662890625;
    var numMapLng = 115.917578125;
    var intMapZoom = 10;
    var arr = [];
    var arr2 =[];
	var start1,start2,end1,end2;//计划出发点，实际出发点，计划终点，实际终点
	var mk;
    var getMapWidth = function () {
        return $("#map").width();
    };
    var getMapHeight = function () {
        return $("#map").height();
    };
    //初始化地图
	 function inintMainMap() {
            RMapConstant.MapMinLevel = 0;
            RMapConstant.MapMaxLevel = 12;

            $("#map").empty();
            Map = new RMap("map", numMapLng, numMapLat, intMapZoom, getMapWidth(), getMapHeight());
            Map.show();
            ToolManager = new RToolManager(Map);
            ToolManager.addScale(10, null, null, 23);
            ToolManager.addZoomDirectBar($(window).width() - 80, 100);
            $(window).resize(function () {
                Map.resize(getMapWidth(), getMapHeight());
                ToolManager.ZoomDirectBar.Div.set(getMapWidth() - 80, 100);
            });
        }
	inintMainMap();
	
var arr = [];

arr.push([{ "Cx": 113.37413, "Cy": 23.124651, "name": "40" },{ "Cx": 113.37414, "Cy": 23.124351, "name": "40" },{ "Cx": 113.37414, "Cy": 23.124171, "name": "40" },{ "Cx": 113.37414, "Cy": 23.124131, "name": "40" },{ "Cx": 113.37414, "Cy": 23.124111, "name": "40" },{ "Cx": 113.37415, "Cy": 23.123811, "name": "40" },{ "Cx": 113.37416, "Cy": 23.123311, "name": "40" }]);
arr.push([{ "Cx": 113.37416, "Cy": 23.123311, "name": "40" },{ "Cx": 113.37448, "Cy": 23.122091, "name": "40" },{ "Cx": 113.3746, "Cy": 23.121091, "name": "40" },{ "Cx": 113.3746, "Cy": 23.120811, "name": "40" },{ "Cx": 113.37459, "Cy": 23.120541, "name": "40" },{ "Cx": 113.37458, "Cy": 23.120311, "name": "40" },{ "Cx": 113.37457, "Cy": 23.120101, "name": "40" },{ "Cx": 113.37457, "Cy": 23.120031, "name": "40" },{ "Cx": 113.37457, "Cy": 23.120001, "name": "40" },{ "Cx": 113.37456, "Cy": 23.119911, "name": "40" },{ "Cx": 113.37456, "Cy": 23.119851, "name": "40" },{ "Cx": 113.37454, "Cy": 23.119732, "name": "40" },{ "Cx": 113.37454, "Cy": 23.119642, "name": "40" },{ "Cx": 113.37453, "Cy": 23.119532, "name": "40" },{ "Cx": 113.37451, "Cy": 23.119322, "name": "40" },{ "Cx": 113.374481, "Cy": 23.119232, "name": "40" },{ "Cx": 113.374461, "Cy": 23.119162, "name": "40" },{ "Cx": 113.374431, "Cy": 23.119092, "name": "40" },{ "Cx": 113.374411, "Cy": 23.119052, "name": "40" },{ "Cx": 113.374381, "Cy": 23.118992, "name": "40" },{ "Cx": 113.374351, "Cy": 23.118922, "name": "40" },{ "Cx": 113.374311, "Cy": 23.118842, "name": "40" },{ "Cx": 113.374291, "Cy": 23.118792, "name": "40" },{ "Cx": 113.374271, "Cy": 23.118752, "name": "40" },{ "Cx": 113.374261, "Cy": 23.118713, "name": "40" },{ "Cx": 113.374251, "Cy": 23.118673, "name": "40" },{ "Cx": 113.374242, "Cy": 23.118633, "name": "40" },{ "Cx": 113.374232, "Cy": 23.118613, "name": "40" },{ "Cx": 113.374222, "Cy": 23.118533, "name": "40" },{ "Cx": 113.374222, "Cy": 23.118463, "name": "40" },{ "Cx": 113.374212, "Cy": 23.118383, "name": "40" },{ "Cx": 113.374212, "Cy": 23.118293, "name": "40" }]);
arr.push([{ "Cx": 113.374212, "Cy": 23.118293, "name": "40" },{ "Cx": 113.37422, "Cy": 23.118241, "name": "40" },{ "Cx": 113.37422, "Cy": 23.118201, "name": "40" },{ "Cx": 113.37423, "Cy": 23.118151, "name": "40" },{ "Cx": 113.37424, "Cy": 23.118081, "name": "40" },{ "Cx": 113.37424, "Cy": 23.118001, "name": "40" },{ "Cx": 113.37426, "Cy": 23.117711, "name": "40" },{ "Cx": 113.37427, "Cy": 23.117591, "name": "40" },{ "Cx": 113.37427, "Cy": 23.117511, "name": "40" },{ "Cx": 113.37428, "Cy": 23.117421, "name": "40" },{ "Cx": 113.37429, "Cy": 23.117241, "name": "40" },{ "Cx": 113.37428, "Cy": 23.117051, "name": "40" },{ "Cx": 113.37428, "Cy": 23.116851, "name": "40" },{ "Cx": 113.37432, "Cy": 23.116722, "name": "40" },{ "Cx": 113.37428, "Cy": 23.116042, "name": "40" },{ "Cx": 113.37427, "Cy": 23.115832, "name": "40" }]);
arr.push([{ "Cx": 113.37427, "Cy": 23.115832, "name": "40" },{ "Cx": 113.37421, "Cy": 23.115511, "name": "40" },{ "Cx": 113.3742, "Cy": 23.114971, "name": "40" },{ "Cx": 113.37419, "Cy": 23.114711, "name": "40" },{ "Cx": 113.37416, "Cy": 23.114541, "name": "40" },{ "Cx": 113.37412, "Cy": 23.113341, "name": "40" },{ "Cx": 113.37424, "Cy": 23.113321, "name": "40" },{ "Cx": 113.37427, "Cy": 23.113311, "name": "40" },{ "Cx": 113.37438, "Cy": 23.113311, "name": "40" },{ "Cx": 113.37442, "Cy": 23.113311, "name": "40" },{ "Cx": 113.37448, "Cy": 23.113311, "name": "40" },{ "Cx": 113.37461, "Cy": 23.113351, "name": "40" }]);
arr.push([{ "Cx": 113.37461, "Cy": 23.113351, "name": "40" },{ "Cx": 113.37459, "Cy": 23.114611, "name": "40" },{ "Cx": 113.37443, "Cy": 23.11523, "name": "40" },{ "Cx": 113.37444, "Cy": 23.115401, "name": "40" },{ "Cx": 113.37444, "Cy": 23.11574, "name": "40" },{ "Cx": 113.37448, "Cy": 23.11672, "name": "40" },{ "Cx": 113.37452, "Cy": 23.11686, "name": "40" },{ "Cx": 113.37452, "Cy": 23.11704, "name": "40" },{ "Cx": 113.37453, "Cy": 23.11714, "name": "40" },{ "Cx": 113.37453, "Cy": 23.11718, "name": "40" }]);
arr.push([{ "Cx": 113.37453, "Cy": 23.11718, "name": "40" },{ "Cx": 113.37456, "Cy": 23.117471, "name": "40" },{ "Cx": 113.37457, "Cy": 23.117571, "name": "40" },{ "Cx": 113.3746, "Cy": 23.117801, "name": "40" },{ "Cx": 113.37484, "Cy": 23.119491, "name": "40" },{ "Cx": 113.37484, "Cy": 23.119551, "name": "40" },{ "Cx": 113.37486, "Cy": 23.119651, "name": "40" },{ "Cx": 113.37487, "Cy": 23.119781, "name": "40" },{ "Cx": 113.37489, "Cy": 23.119921, "name": "40" },{ "Cx": 113.3749, "Cy": 23.120021, "name": "40" },{ "Cx": 113.375, "Cy": 23.120781, "name": "40" },{ "Cx": 113.37504, "Cy": 23.121041, "name": "40" },{ "Cx": 113.3751, "Cy": 23.121991, "name": "40" },{ "Cx": 113.37514, "Cy": 23.122391, "name": "40" },{ "Cx": 113.37517, "Cy": 23.122781, "name": "40" },{ "Cx": 113.37518, "Cy": 23.123311, "name": "40" },{ "Cx": 113.37517, "Cy": 23.123611, "name": "40" },{ "Cx": 113.37516, "Cy": 23.123841, "name": "40" },{ "Cx": 113.37516, "Cy": 23.124111, "name": "40" },{ "Cx": 113.37515, "Cy": 23.124181, "name": "40" },{ "Cx": 113.37512, "Cy": 23.125291, "name": "40" },{ "Cx": 113.37519, "Cy": 23.125991, "name": "40" },{ "Cx": 113.37535, "Cy": 23.126691, "name": "40" },{ "Cx": 113.37542, "Cy": 23.126971, "name": "40" },{ "Cx": 113.37548, "Cy": 23.127191, "name": "40" },{ "Cx": 113.3755, "Cy": 23.127311, "name": "40" },{ "Cx": 113.37551, "Cy": 23.127351, "name": "40" },{ "Cx": 113.37552, "Cy": 23.127371, "name": "40" },{ "Cx": 113.37553, "Cy": 23.127391, "name": "40" },{ "Cx": 113.37554, "Cy": 23.127421, "name": "40" },{ "Cx": 113.37555, "Cy": 23.127471, "name": "40" },{ "Cx": 113.37556, "Cy": 23.127531, "name": "40" },{ "Cx": 113.37557, "Cy": 23.127571, "name": "40" },{ "Cx": 113.37563, "Cy": 23.127841, "name": "40" },{ "Cx": 113.37594, "Cy": 23.129071, "name": "40" },{ "Cx": 113.37597, "Cy": 23.129191, "name": "40" },{ "Cx": 113.37601, "Cy": 23.12939, "name": "40" },{ "Cx": 113.37606, "Cy": 23.12959, "name": "40" },{ "Cx": 113.37624, "Cy": 23.13031, "name": "40" },{ "Cx": 113.37633, "Cy": 23.13069, "name": "40" },{ "Cx": 113.37649, "Cy": 23.131351, "name": "40" },{ "Cx": 113.37671, "Cy": 23.132251, "name": "40" },{ "Cx": 113.37674, "Cy": 23.132431, "name": "40" },{ "Cx": 113.37675, "Cy": 23.13247, "name": "40" },{ "Cx": 113.37678, "Cy": 23.132681, "name": "40" },{ "Cx": 113.37678, "Cy": 23.132751, "name": "40" },{ "Cx": 113.37679, "Cy": 23.132831, "name": "40" },{ "Cx": 113.37677, "Cy": 23.133121, "name": "40" },{ "Cx": 113.376731, "Cy": 23.133401, "name": "40" },{ "Cx": 113.376681, "Cy": 23.133641, "name": "40" },{ "Cx": 113.376631, "Cy": 23.133801, "name": "40" },{ "Cx": 113.376591, "Cy": 23.133951, "name": "40" },{ "Cx": 113.376521, "Cy": 23.134131, "name": "40" },{ "Cx": 113.376391, "Cy": 23.134421, "name": "40" },{ "Cx": 113.376251, "Cy": 23.134761, "name": "40" },{ "Cx": 113.376181, "Cy": 23.134961, "name": "40" }]);
arr.push([{ "Cx": 113.376181, "Cy": 23.134961, "name": "40" },{ "Cx": 113.37615, "Cy": 23.135021, "name": "40" },{ "Cx": 113.37607, "Cy": 23.135331, "name": "40" },{ "Cx": 113.37606, "Cy": 23.135451, "name": "40" },{ "Cx": 113.37607, "Cy": 23.135811, "name": "40" },{ "Cx": 113.37608, "Cy": 23.135951, "name": "40" },{ "Cx": 113.37622, "Cy": 23.136691, "name": "40" },{ "Cx": 113.37634, "Cy": 23.137151, "name": "40" },{ "Cx": 113.37644, "Cy": 23.137571, "name": "40" },{ "Cx": 113.37652, "Cy": 23.138001, "name": "40" },{ "Cx": 113.37663, "Cy": 23.138381, "name": "40" },{ "Cx": 113.37671, "Cy": 23.138731, "name": "40" },{ "Cx": 113.37675, "Cy": 23.138891, "name": "40" },{ "Cx": 113.3768, "Cy": 23.139061, "name": "40" },{ "Cx": 113.37692, "Cy": 23.139551, "name": "40" },{ "Cx": 113.37732, "Cy": 23.141231, "name": "40" },{ "Cx": 113.37756, "Cy": 23.142251, "name": "40" },{ "Cx": 113.37768, "Cy": 23.142731, "name": "40" },{ "Cx": 113.37795, "Cy": 23.143671, "name": "40" },{ "Cx": 113.378, "Cy": 23.143811, "name": "40" },{ "Cx": 113.37809, "Cy": 23.144111, "name": "40" },{ "Cx": 113.37811, "Cy": 23.144171, "name": "40" },{ "Cx": 113.37846, "Cy": 23.144971, "name": "40" },{ "Cx": 113.37856, "Cy": 23.145201, "name": "40" }]);
arr.push([{ "Cx": 113.37856, "Cy": 23.145201, "name": "40" },{ "Cx": 113.37866, "Cy": 23.145541, "name": "40" },{ "Cx": 113.37869, "Cy": 23.145681, "name": "40" },{ "Cx": 113.37873, "Cy": 23.146211, "name": "40" },{ "Cx": 113.37871, "Cy": 23.146951, "name": "40" },{ "Cx": 113.3787, "Cy": 23.147471, "name": "40" },{ "Cx": 113.3787, "Cy": 23.147551, "name": "40" },{ "Cx": 113.37868, "Cy": 23.148471, "name": "40" },{ "Cx": 113.3787, "Cy": 23.149011, "name": "40" },{ "Cx": 113.37876, "Cy": 23.149441, "name": "40" },{ "Cx": 113.3788, "Cy": 23.149611, "name": "40" },{ "Cx": 113.37924, "Cy": 23.150791, "name": "40" },{ "Cx": 113.37937, "Cy": 23.151071, "name": "40" },{ "Cx": 113.37991, "Cy": 23.151881, "name": "40" },{ "Cx": 113.37998, "Cy": 23.151971, "name": "40" },{ "Cx": 113.38009, "Cy": 23.152141, "name": "40" },{ "Cx": 113.38019, "Cy": 23.152281, "name": "40" },{ "Cx": 113.38072, "Cy": 23.153081, "name": "40" },{ "Cx": 113.38157, "Cy": 23.154331, "name": "40" },{ "Cx": 113.38169, "Cy": 23.154511, "name": "40" },{ "Cx": 113.38184, "Cy": 23.154771, "name": "40" },{ "Cx": 113.38197, "Cy": 23.155051, "name": "40" },{ "Cx": 113.38208, "Cy": 23.155291, "name": "40" },{ "Cx": 113.38218, "Cy": 23.155591, "name": "40" },{ "Cx": 113.38228, "Cy": 23.156011, "name": "40" },{ "Cx": 113.38234, "Cy": 23.156481, "name": "40" },{ "Cx": 113.38233, "Cy": 23.157411, "name": "40" },{ "Cx": 113.38228, "Cy": 23.158551, "name": "40" },{ "Cx": 113.38227, "Cy": 23.158881, "name": "40" },{ "Cx": 113.38228, "Cy": 23.159321, "name": "40" },{ "Cx": 113.38227, "Cy": 23.159501, "name": "40" },{ "Cx": 113.38227, "Cy": 23.159641, "name": "40" },{ "Cx": 113.38229, "Cy": 23.161391, "name": "40" },{ "Cx": 113.3823, "Cy": 23.161661, "name": "40" },{ "Cx": 113.3823, "Cy": 23.161701, "name": "40" },{ "Cx": 113.3823, "Cy": 23.161901, "name": "40" },{ "Cx": 113.3823, "Cy": 23.164461, "name": "40" },{ "Cx": 113.382261, "Cy": 23.164891, "name": "40" },{ "Cx": 113.382241, "Cy": 23.165241, "name": "40" },{ "Cx": 113.382231, "Cy": 23.165321, "name": "40" },{ "Cx": 113.382231, "Cy": 23.165371, "name": "40" },{ "Cx": 113.382221, "Cy": 23.165441, "name": "40" },{ "Cx": 113.382211, "Cy": 23.165521, "name": "40" },{ "Cx": 113.382211, "Cy": 23.165611, "name": "40" }]);


	//计划路线
	 window.data = [{ "longitude": 115.9184479596, "latitude": 28.6425262863, "name": "40" },
	{ "longitude": 115.9221101610, "latitude":28.6469114985, "name": "40" },
	{ "longitude": 115.9247908817, "latitude":28.6518986243, "name": "40" },
	{ "longitude": 115.9252228817, "latitude":28.6545926243,"name": "42" },
	{ "longitude": 115.9256538817, "latitude":28.6568746243,"name": "42" }
	]; 
	//实际路线
	window.data2 = [{ "longitude": 115.9184479596, "latitude": 28.6425262863, "name": "40" },
	{ "longitude": 115.9221101610, "latitude":28.6469114985, "name": "40" },
	{ "longitude": 115.9344472562 , "latitude":28.6434493968,"name": "40" },
	{ "longitude": 115.9351122562, "latitude":28.6467333968,"name": "40" },
	{ "longitude": 115.9387176978 , "latitude":28.6524144111,"name": "40" },
	{ "longitude": 115.9322715977 , "latitude":28.6542685270,"name": "40" },
	{ "longitude": 115.9292535977,"latitude":28.6547435270,"name": "40" },
	{ "longitude": 115.9252228817, "latitude":28.6545926243,"name": "42" },
	{ "longitude": 115.9256538817, "latitude":28.6568746243,"name": "42" },
	{ "longitude": 115.9273833409, "latitude":28.6598575382,"name": "42" }];
	//车辆路线
	var carLine = function(timeSpeed,allData){
		 this.timeSpeed = timeSpeed;
		 this.payCount = 0;
		 this.allData = allData;
		 //添加路线
		 this.reSetLine = function () {
            var d = this.allData;
            for (var i = 0; i < d.length; i++) {
                if (i == 0) {//第一次循环，定位到地图中心点
                    var item = d[i];
                    start1 = d[i];
                    Map.setCenter(item.longitude, item.latitude);
                }
                if(i==d.length-1){
                	end1 = d[i];
                }
                var tm = {};
                var tm2 = {};
                tm.Cx = d[i].longitude;
                tm.Cy = d[i].latitude;
                tm.index = i;
               
                arr.push(tm);
                
            }
			d = [];
			d= window.data2;
			for (var i = 0; i < d.length; i++) {
                if (i == 0) {//第一次循环，定位到地图中心点
                    var item = d[i];
                    start2 = d[i];
                    Map.setCenter(item.longitude, item.latitude);
                }
                if(i==d.length-1){
                	end2 = d[i];
                }                
                var tm = {};
                var tm2 = {};
                tm.Cx = d[i].longitude;
                tm.Cy = d[i].latitude;
                tm.index = i;
               
                arr2.push(tm);
            }
       };
       //画计划路线
       this.drawLine = function (runData) {
            
            Map.rline = new RLine(runData, 4, "green", 0.8);
            Map.addGraphics(Map.rline);
            Map.refreshGraphics(Map.rline);
            
       };
		//画实际路线
	    this.drawBlueLine = function (runData) {
            Map.blueline = new RLine(runData, 4, "blue", 0.8);
            Map.addGraphics(Map.blueline);
            Map.refreshGraphics(Map.blueline);
            
       };
	   //画起点终点标注
       this.addMarker = function(marker,status) {
	   //判断标注状态，设置标注
				var img = "./img/visited_stops.png";
				var address = "";
				if(status==1){
					address="计划出发点";
					img = "./img/start.png";
				}else if(status==0){
					address="计划终点";
					img = "./img/end.png";
				}else if(status==2){
					address="实际出发点";
					img = "./img/start.png";
				}else if(status==3){
					address="实际终点";
					img = "./img/end.png";
				}
				this.marker = new RTabMarker(marker.longitude, marker.latitude, {html: "",detaX: 0,detaY: 0 }, img, -15, -40, 30,40);
				//添加标注
				Map.addMarker(this.marker);
				//显示label框
				this.marker.showLabel();
				mk = this.marker;
			};
			//初始化操作按钮
		this.initRightPart = function () {//右边部分的html处理
            $("body").append('<div class="playSchedule">' 
           				 + '<div class="locusmap-his-button" id="plan-line">计划路线</div>'
						 + '<div class="locusmap-his-button" id="real-line">实际路线</div>'
						 + '<div class="locusmap-his-button" id="both-line">路线比较</div>'
						 + '<div class="locusmap-his-button" id="clear-line">清除路线</div>'
						 + '</div>'
						 + '');
            this.initRightPartEven();
           
            this.Map = Map;
         
        },
        this.initRightPartEven = function () {//初始化事件
            this.rightPart_up(); //上部数据显示
        };
		//按钮操作
        this.rightPart_up = function () {
        	var that = this;
           //计划路线
            $("#plan-line").click(function () {
				//移除所有图形
				Map.removeAllGraphics();
				//移除所有标注
				Map.removeAllMarker();
				//重新绘制路线和起点，终点
				addMarker(start1,1);
				addMarker(end1,0);
                 drawLine(arr); //画线
            });
            
            //实际路线
            $("#real-line").click(function () {
				//移除所有图形
				Map.removeAllGraphics();
				//移除所有标注
				Map.removeAllMarker();
				//重新绘制路线和起点，终点
				addMarker(start2,2);
				addMarker(end2,3);
                drawBlueLine(arr2); //画线;
            });
            
           //路线比较
           $("#both-line").click(function () {
				//移除所有图形
				Map.removeAllGraphics();
				//移除所有标注
				Map.removeAllMarker();
				//重新绘制路线和起点，终点
				addMarker(start1,1);
				addMarker(end1,0);
				addMarker(start2,2);
				addMarker(end2,3);
				drawBlueLine(arr2); //画线
                drawLine(arr); //画线
				
            });
          
            //清除路线
            $("#clear-line").click(function () {
				Map.removeAllGraphics();
				Map.removeAllMarker();
            });
        };
       this.init = function(){
       	this.reSetLine();
		this.initRightPart();
       }
       
       this.init();
	}
	
	for(var i = 0 ;i<arr.length ; i++){
		//carLine(200,arr[i]);
		 Map.blueline = new RLine(arr[i], 4, "blue", 0.8);
            Map.addGraphics(Map.blueline);
            Map.refreshGraphics(Map.blueline);
	}
	  Map.setCenter(113.38797, 23.126811);
	alert(arr.length);
	//carLine(200,window.data);
	
	
</script>
</html>
